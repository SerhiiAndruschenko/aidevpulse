# üßπ –û—á–∏—â–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–¢–∞–±–ª–∏—Ü—è `raw_items` —à–≤–∏–¥–∫–æ –Ω–∞–∫–æ–ø–∏—á—É—î —Ç–∏—Å—è—á—ñ –∑–∞–ø–∏—Å—ñ–≤, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ:
- –ü–æ–≤—ñ–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –±–∞–∑–∏
- –ü—Ä–æ–±–ª–µ–º –∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è

### **1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è –≤ FastIngestService:**
```typescript
// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Å—ñ–≤
const currentCount = await Database.getRawItemsCount();
console.log(`Current raw items in database: ${currentCount}`);

// –û—á–∏—â–µ–Ω–Ω—è —è–∫—â–æ –±—ñ–ª—å—à–µ 1000 –∑–∞–ø–∏—Å—ñ–≤
if (currentCount > 1000) {
  console.log('üßπ Cleaning old raw items (keeping last 7 days)...');
  const deletedCount = await Database.clearOldRawItems(7);
  console.log(`‚úÖ Deleted ${deletedCount} old raw items`);
}
```

### **2. –ù–æ–≤—ñ –º–µ—Ç–æ–¥–∏ –≤ Database:**
```typescript
// –û—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ (–∑–∞–ª–∏—à–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ N –¥–Ω—ñ–≤)
static async clearOldRawItems(daysToKeep: number = 7): Promise<number>

// –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–ø–∏—Å—ñ–≤
static async getRawItemsCount(): Promise<number>
```

### **3. –õ–æ–≥—ñ–∫–∞ –æ—á–∏—â–µ–Ω–Ω—è:**
- **–¢—Ä–∏–≥–µ—Ä:** –ö–æ–ª–∏ –≤ –±–∞–∑—ñ –±—ñ–ª—å—à–µ 1000 –∑–∞–ø–∏—Å—ñ–≤
- **–ö—Ä–∏—Ç–µ—Ä—ñ–π:** –í–∏–¥–∞–ª—è—î –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à—ñ 7 –¥–Ω—ñ–≤
- **–ë–µ–∑–ø–µ–∫–∞:** –ó–±–µ—Ä—ñ–≥–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É

## üìä –õ–æ–≥—É–≤–∞–Ω–Ω—è

### **–î–æ –æ—á–∏—â–µ–Ω–Ω—è:**
```
üöÄ Starting fast ingest (top sources only)...
Current raw items in database: 2847
üßπ Cleaning old raw items (keeping last 7 days)...
‚úÖ Deleted 1847 old raw items
```

### **–ü—ñ—Å–ª—è ingest:**
```
‚úÖ Inserted 60 new items
üìä Total raw items in database: 1060
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –æ—á–∏—â–µ–Ω–Ω—è:**
- **–õ—ñ–º—ñ—Ç:** 1000 –∑–∞–ø–∏—Å—ñ–≤ (—Ç—Ä–∏–≥–µ—Ä –æ—á–∏—â–µ–Ω–Ω—è)
- **–ü–µ—Ä—ñ–æ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:** 7 –¥–Ω—ñ–≤
- **–ß–∞—Å—Ç–æ—Ç–∞:** –ü—Ä–∏ –∫–æ–∂–Ω–æ–º—É cron –∑–∞–ø—É—Å–∫—É

### **–ú–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏:**
```typescript
// –ó–º—ñ–Ω–∏—Ç–∏ –ª—ñ–º—ñ—Ç
if (currentCount > 500) { // –∑–∞–º—ñ—Å—Ç—å 1000

// –ó–º—ñ–Ω–∏—Ç–∏ –ø–µ—Ä—ñ–æ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
await Database.clearOldRawItems(14); // –∑–∞–º—ñ—Å—Ç—å 7
```

## üìà –ü–µ—Ä–µ–≤–∞–≥–∏

### **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:**
- ‚úÖ –®–≤–∏–¥—à–∞ —Ä–æ–±–æ—Ç–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
- ‚úÖ –ú–µ–Ω—à–∏–π —Ä–æ–∑–º—ñ—Ä –±–∞–∑–∏
- ‚úÖ –®–≤–∏–¥—à–∏–π –ø–æ—à—É–∫ —Ç–∞ –∞–Ω–∞–ª—ñ–∑

### **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è:**
- ‚úÖ –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä—É—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä–æ–º
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö

### **–ë–µ–∑–ø–µ–∫–∞:**
- ‚úÖ –ó–±–µ—Ä—ñ–≥–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤
- ‚úÖ –ù–µ –≤–∏–¥–∞–ª—è—î –≤–∞–∂–ª–∏–≤—ñ –¥–∞–Ω—ñ
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏:**
```bash
# –ó–∞–ø—É—Å—Ç—ñ—Ç—å cron job
curl https://www.aidevpulse.tech/api/cron/trigger

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:
# - "Current raw items in database: X"
# - "Cleaning old raw items..." (—è–∫—â–æ > 1000)
# - "Deleted X old raw items"
# - "Total raw items in database: Y"
```

### **–ö—Ä–∏—Ç–µ—Ä—ñ—ó —É—Å–ø—ñ—Ö—É:**
- ‚úÖ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ –Ω–µ –ø–µ—Ä–µ–≤–∏—â—É—î 1000
- ‚úÖ –ó–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –¥–∞–Ω—ñ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤
- ‚úÖ –ù–æ–≤–∏–π ingest –ø—Ä–∞—Ü—é—î —à–≤–∏–¥—à–µ
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—É—é—Ç—å –ø—Ä–æ—Ü–µ—Å –æ—á–∏—â–µ–Ω–Ω—è

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### **–î–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:**
- ‚ùå 5000+ –∑–∞–ø–∏—Å—ñ–≤ –≤ raw_items
- ‚ùå –ü–æ–≤—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ –±–∞–∑–∏
- ‚ùå –†—É—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è

### **–ü—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:**
- ‚úÖ < 1000 –∑–∞–ø–∏—Å—ñ–≤ –∑–∞–≤–∂–¥–∏
- ‚úÖ –®–≤–∏–¥–∫–∞ —Ä–æ–±–æ—Ç–∞ –±–∞–∑–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è

---

**üí° –†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –∑–∞–≤–∂–¥–∏ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —á–∏—Å—Ç–æ—é —Ç–∞ —à–≤–∏–¥–∫–æ—é!
