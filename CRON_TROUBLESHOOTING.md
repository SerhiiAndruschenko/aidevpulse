# üîß Cron Jobs Troubleshooting Guide

–Ø–∫—â–æ cron –∑–∞–¥–∞—á—ñ –≤ Vercel –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å –∞–±–æ —Å—Ç–∞—Ç—Ç—ñ –Ω–µ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ, –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

## üöÄ –®–≤–∏–¥–∫–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–∏–π —Å–∫—Ä–∏–ø—Ç

```bash
npm run diagnose:cron
```

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å:
- ‚úÖ –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
- ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
- ‚úÖ –ù–∞—è–≤–Ω—ñ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—å
- ‚úÖ –ê–∫—Ç–∏–≤–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö
- ‚úÖ –û—Å—Ç–∞–Ω–Ω—ñ –¥–∞–Ω—ñ —Ç–∞ —Å—Ç–∞—Ç—Ç—ñ
- ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ AI —Å–µ—Ä–≤—ñ—Å—É

### 2. –ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ cron endpoints

```bash
npm run test:cron
```

## üîç –î–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤ Vercel –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –≤—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –∑–º—ñ–Ω–Ω—ñ:

**–û–±–æ–≤'—è–∑–∫–æ–≤—ñ:**
- `DATABASE_URL` - URL –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ PostgreSQL
- `GEMINI_API_KEY` - API –∫–ª—é—á Google Gemini

**–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ:**
- `CRON_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É cron endpoints
- `SITE_URL` - URL –≤–∞—à–æ–≥–æ —Å–∞–π—Ç—É
- `IMAGE_API_KEY` - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑–æ–±—Ä–∞–∂–µ–Ω—å

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

1. **–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–∞–±–ª–∏—Ü—ñ:**
```bash
npm run db:migrate
```

2. **–î–æ–¥–∞–π—Ç–µ –¥–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö:**
```bash
npm run db:seed
```

3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∞–∫—Ç–∏–≤–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞:**
```sql
SELECT name, kind, url, active FROM sources WHERE active = true;
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ cron –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

–£ —Ñ–∞–π–ª—ñ `vercel.json` –º–∞—î –±—É—Ç–∏:

```json
{
  "crons": [
    {
      "path": "/api/cron/content-pipeline",
      "schedule": "0 6 * * *"
    },
    {
      "path": "/api/cron/quality-check", 
      "schedule": "0 8 * * *"
    }
  ]
}
```

## üêõ –¢–∏–ø–æ–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ü—Ä–æ–±–ª–µ–º–∞: "No active sources found"

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å `npm run db:seed`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –¥–∂–µ—Ä–µ–ª–∞ –∞–∫—Ç–∏–≤–Ω—ñ:
```sql
UPDATE sources SET active = true;
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Database connection failed"

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `DATABASE_URL` –≤ Vercel
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ SSL –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è production

### –ü—Ä–æ–±–ª–µ–º–∞: "Gemini AI connection failed"

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `GEMINI_API_KEY` –≤ Vercel
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ API –∫–ª—é—á –≤–∞–ª—ñ–¥–Ω–∏–π
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–≤–æ—Ç–∏ —Ç–∞ –ª—ñ–º—ñ—Ç–∏ API

### –ü—Ä–æ–±–ª–µ–º–∞: "No articles generated"

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ —î –Ω–æ–≤—ñ –¥–∞–Ω—ñ –≤ `items_raw`
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ä—É—á–Ω–∏–π —Ç–µ—Å—Ç:
```bash
curl -X POST https://your-domain.vercel.app/api/cron/content-pipeline
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Unauthorized" –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ

**–†—ñ—à–µ–Ω–Ω—è:**
1. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å `CRON_SECRET` –≤ Vercel
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```bash
curl -X POST https://your-domain.vercel.app/api/cron/content-pipeline \
  -H "Authorization: Bearer YOUR_CRON_SECRET"
```

## üß™ –†—É—á–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
npm run diagnose:cron

# –ù–∞ Vercel
curl https://your-domain.vercel.app/api/cron/content-pipeline
```

### –¢–µ—Å—Ç 2: –†—É—á–Ω–∏–π –∑–∞–ø—É—Å–∫ content pipeline

```bash
curl -X POST https://your-domain.vercel.app/api/cron/content-pipeline \
  -H "Authorization: Bearer YOUR_CRON_SECRET"
```

### –¢–µ—Å—Ç 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ª–æ–≥—ñ–≤ Vercel

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Vercel Dashboard
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ Functions
3. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ª–æ–≥–∏ cron jobs

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É cron jobs

1. **Vercel Dashboard** ‚Üí Functions ‚Üí Cron Jobs
2. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –æ—Å—Ç–∞–Ω–Ω—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–º–∏–ª–∫–∏

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–∞–Ω–∏—Ö

```sql
-- –û—Å—Ç–∞–Ω–Ω—ñ —Å—Ç–∞—Ç—Ç—ñ
SELECT title, published_at, review_status 
FROM articles 
ORDER BY published_at DESC 
LIMIT 5;

-- –û—Å—Ç–∞–Ω–Ω—ñ –¥–∞–Ω—ñ
SELECT title, created_at 
FROM items_raw 
ORDER BY created_at DESC 
LIMIT 10;

-- –ê–∫—Ç–∏–≤–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞
SELECT name, kind, active 
FROM sources 
WHERE active = true;
```

## üö® –ï–∫—Å—Ç—Ä–µ–Ω—ñ –∑–∞—Ö–æ–¥–∏

–Ø–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –¥–æ–ø–æ–º–∞–≥–∞—î:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å deployment:**
   - Vercel Dashboard ‚Üí Deployments ‚Üí Redeploy

2. **–û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à:**
   - Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables ‚Üí Save (–±–µ–∑ –∑–º—ñ–Ω)

3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å Vercel:**
   - https://vercel-status.com/

4. **–ó–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏:**
   - Vercel Support
   - GitHub Issues

## üìù –õ–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É

–ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ –ª–æ–≥–∏ –∑:
- Vercel Functions
- Database queries
- AI API responses
- Cron job executions

–¶–µ –¥–æ–ø–æ–º–æ–∂–µ —à–≤–∏–¥—à–µ –∑–Ω–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º–∏.

---

**üí° –ü–æ—Ä–∞–¥–∞:** –ó–∞–≤–∂–¥–∏ —Ç–µ—Å—Ç—É–π—Ç–µ –∑–º—ñ–Ω–∏ –ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ—î–º –Ω–∞ Vercel!
